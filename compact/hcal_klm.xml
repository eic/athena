<lccdd>

  <define>
    <constant name="HcalBarrel_offset"              value="(HcalEndcapP_zmin-HcalEndcapN_zmin)/2.0" />

    <constant name="HcalSteelThickness"             value="1.89 * cm" />

    <comment>
      Scintillator light detection in the strip
      Figure 10.20 (b), Belle II Technical Design Report,
      https://docs.belle2.org/record/329/files/BELLE2-REPORT-2016-001.pdf
      4 cm wide scintillator strips are read out along WLS fibers
      strips are oriented z-phi in barrel, x-y in endcaps
    </comment>
    <constant name="HcalScintillatorNbLayers"       value="2" />
    <constant name="HcalScintillatorPSThickness"    value="300*um" />
    <constant name="HcalScintillatorWidth"          value="40*mm" />
    <constant name="HcalScintillatorThickness"      value="10*mm" />

    <comment> Single Layer Thickness (for both barrel and endcap)</comment>
    <constant name="HcalScintillatorSingleLayerThickness"
      value="HcalSteelThickness + 2 * (HcalScintillatorThickness + 2 * HcalScintillatorPSThickness)"/>

    <comment> All Scintillator Layers Thickness (for both barrel and endcap)</comment>
    <constant name="HcalScintillatorAllLayerThickness" value="HcalScintillatorNbLayers * HcalScintillatorSingleLayerThickness"/>

    <comment>
      Exploded cross-section of an RPC superlayer
      Figure 10.2, Belle II Technical Design Report, 
      https://docs.belle2.org/record/329/files/BELLE2-REPORT-2016-001.pdf
      RPC layers are read out on 5 cm wide strips
      strips are oriented along z-phi in barrel, r-phi in endcaps
    </comment>
    <constant name="HcalRPCMylarThickness"          value="0.25*mm" />
    <constant name="HcalRPCCopperThickness"         value="0.035*mm" />
    <constant name="HcalRPCPSFoamThickness"         value="7.0*mm" />
    <constant name="HcalRPCGlassThickness"          value="3.0*mm" />
    <constant name="HcalRPCGasThickness"            value="2.0*mm" />

    <comment> Single Layer Thickness (for both barrel and endcap)</comment>
    <constant name="HcalRPCSingleLayerThickness"
      value="HcalSteelThickness + 2 * (2 * (HcalRPCMylarThickness + HcalRPCCopperThickness) + HcalRPCPSFoamThickness + 2 * HcalRPCGlassThickness + HcalRPCGasThickness) + HcalRPCMylarThickness"/>

    <comment> Hcal Barrel Layers and computed Thickness </comment>
    <constant name="HcalBarrelAvailThicknessForRPC" value="HcalBarrelAvailThickness - HcalScintillatorAllLayerThickness"/>
    <constant name="HcalBarrelLayerRPC_NRepeat" value="floor(HcalBarrelAvailThicknessForRPC / HcalRPCSingleLayerThickness)"/>
    <constant name="HcalBarrelThickness" value="HcalScintillatorAllLayerThickness + HcalBarrelLayerRPC_NRepeat * HcalRPCSingleLayerThickness"/>

    <comment> Hcal Endcap Layers and computed Thickness </comment>
    <constant name="HcalEndcapP_AvailLengthRPC" value="HcalEndcapP_length - HcalScintillatorAllLayerThickness"/>
    <constant name="HcalEndcapN_AvailLengthRPC" value="HcalEndcapN_length - HcalScintillatorAllLayerThickness"/>
    <constant name="HcalEndcapPLayer_NRepeat" value="floor(HcalEndcapP_AvailLengthRPC / HcalRPCSingleLayerThickness)"/>
    <constant name="HcalEndcapNLayer_NRepeat" value="floor(HcalEndcapN_AvailLengthRPC / HcalRPCSingleLayerThickness)"/>
    <constant name="HcalEndcapP_thickness" value="HcalEndcapPLayer_NRepeat * HcalRPCSingleLayerThickness"/>
    <constant name="HcalEndcapN_thickness" value="HcalEndcapNLayer_NRepeat * HcalRPCSingleLayerThickness"/>
  </define>

  <limits>
  </limits>

  <regions>
  </regions>

  <display>
  </display>

  <!-- Define detector -->
  <detectors>

    <detector 
      id="HCalBarrel_ID" 
      name="HcalBarrel"
      type="athena_EcalBarrel"
      readout="HcalBarrelHits"
      calorimeterType="HAD_BARREL"
      offset="HcalBarrel_offset"
      gap="0.*cm"
      material="Steel235">
      <dimensions 
        numsides="CaloSides" 
        rmin="HcalBarrel_rmin" 
        z="HcalBarrelLength"/>
      <staves vis="HcalBarrelVis"/>
      <layer repeat="HcalScintillatorNbLayers">
        <slice material="Steel235"     thickness="HcalSteelThickness" vis="AnlGray"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="PlasticScint" thickness="HcalScintillatorThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="PlasticScint" thickness="HcalScintillatorThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
      </layer>
      <layer repeat="HcalBarrelLayerRPC_NRepeat - HcalScintillatorNbLayers">
        <slice material="Steel235"        thickness="HcalSteelThickness" vis="AnlGray"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness" vis="AnlGreen"/>
        <slice material="PolystyreneFoam" thickness="HcalRPCPSFoamThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness" sensitive="yes" limits="cal_limits" vis="AnlGreen"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="RPCGasDefault"   thickness="HcalRPCGasThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="RPCGasDefault"   thickness="HcalRPCGasThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness" sensitive="yes" limits="cal_limits" vis="AnlGreen"/>
        <slice material="PolystyreneFoam" thickness="HcalRPCPSFoamThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness" vis="AnlGreen"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
      </layer>
    </detector>

    <detector 
      id="HCalEndcapP_ID" 
      name="HcalEndcapP" 
      type="refdet_PolyhedraEndcapCalorimeter2" 
      readout="HcalEndcapHits" 
      vis="HcalEndcapVis" 
      calorimeterType="HAD_ENDCAP"
      reflect="false">
      <position x="0" y="0" z="0"/>
      <dimensions 
        numsides="CaloSides" 
        zmin="HcalEndcapP_zmin" 
        rmin="HcalEndcapP_rmin"
        rmax="HcalBarrel_rmax"/>
      <layer repeat="HcalScintillatorNbLayers" vis="HcalEndcapVis">
        <slice material="Steel235"     thickness="HcalSteelThickness"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="PlasticScint" thickness="HcalScintillatorThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="PlasticScint" thickness="HcalScintillatorThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
      </layer>
      <layer repeat="HcalEndcapPLayer_NRepeat - HcalScintillatorNbLayers" vis="HcalEndcapVis">
        <slice material="Steel235"        thickness="HcalSteelThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness"/>
        <slice material="PolystyreneFoam" thickness="HcalRPCPSFoamThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="RPCGasDefault"   thickness="HcalRPCGasThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="RPCGasDefault"   thickness="HcalRPCGasThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="PolystyreneFoam" thickness="HcalRPCPSFoamThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
      </layer>
    </detector>

    <detector 
      id="HCalEndcapN_ID" 
      name="HcalEndcapN" 
      type="refdet_PolyhedraEndcapCalorimeter2" 
      readout="HcalEndcapHits" 
      vis="HcalEndcapVis" 
      calorimeterType="HAD_ENDCAP" reflect="true">
      <position x="0" y="0" z="0"/>
      <dimensions 
        numsides="CaloSides" 
        zmin="HcalEndcapN_zmin" 
        rmin="HcalEndcapN_rmin" 
        rmax="HcalBarrel_rmax"/>
      <layer repeat="HcalScintillatorNbLayers" vis="HcalEndcapVis">
        <slice material="Steel235"     thickness="HcalSteelThickness"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="PlasticScint" thickness="HcalScintillatorThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
        <slice material="PlasticScint" thickness="HcalScintillatorThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="Polystyrene"  thickness="HcalScintillatorPSThickness"/>
      </layer>
      <layer repeat="HcalEndcapNLayer_NRepeat - HcalScintillatorNbLayers" vis="HcalEndcapVis">
        <slice material="Steel235"        thickness="HcalSteelThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness"/>
        <slice material="PolystyreneFoam" thickness="HcalRPCPSFoamThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="RPCGasDefault"   thickness="HcalRPCGasThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="RPCGasDefault"   thickness="HcalRPCGasThickness"/>
        <slice material="PyrexGlass"      thickness="HcalRPCGlassThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness" sensitive="yes" limits="cal_limits"/>
        <slice material="PolystyreneFoam" thickness="HcalRPCPSFoamThickness"/>
        <slice material="Copper"          thickness="HcalRPCCopperThickness"/>
        <slice material="Mylar"           thickness="HcalRPCMylarThickness"/>
      </layer>
    </detector>

  </detectors>
  <!--  Definition of the readout segmentation/definition  -->
  <readouts>
    <readout name="HcalBarrelHits">
      <segmentation type="CartesianGridXY" grid_size_x="5 * cm" grid_size_y="5 * cm"/>
      <id>system:6,barrel:3,module:4,layer:8,slice:5,x:32:-16,y:-16</id>
    </readout>
    <readout name="HcalEndcapHits">
      <segmentation type="CartesianGridXY" grid_size_x="5 * cm" grid_size_y="5 * cm"/>
      <id>system:6,barrel:3,module:4,layer:8,slice:5,x:32:-16,y:-16</id>
    </readout>
  </readouts>

  <plugins>
  </plugins>

  <fields>
  </fields>
</lccdd>
