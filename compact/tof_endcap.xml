<?xml version="1.0" encoding="UTF-8"?>
<lccdd>
  <define>
    <comment>
      --------------------------
      Forward and backward TOF Parameters
      --------------------------
    </comment>
    
    <constant name="TOFSensor_thickness"         value="0.03*mm"/>
    <constant name="TOFEndcap_thickness"        value="0.25/100*9.37*cm"/>
    <constant name="TOFEndcapService_thickness" value="TOFEndcap_thickness-TOFSensor_thickness"/>

    <constant name="TOFEndcap_nLayers"          value="2"/>

    <constant name="TOFEndcapOuter_zmin"        value="TOFBarrelOuter_length/2.0"/>
    <constant name="TOFEndcapOuter_zmax"        value="TOFEndcapOuter_zmin + 10*cm"/>
    <constant name="TOFEndcapOuter_length"        value="TOFEndcapOuter_zmax- TOFEndcapOuter_zmin"/>
    <constant name="TOFEndcapOuterLayer_dz"        value="TOFEndcapOuter_length/TOFEndcapOuter_nLayers"/>

    <constant name="TOFEndcapOuter_rmin1" value="3.18*cm + 1.2*cm * 0"/>
    <constant name="TOFEndcapOuter_rmin2" value="3.18*cm + 1.2*cm * 1"/>

    <constant name="TOFEndcapOuter_rmax1"  value="43.23*cm"/>
    <constant name="TOFEndcapOuter_rmax2"  value="43.23*cm"/>
    
    <constant name="TOFEndcapOuterModOpeningAngle" value="30.0*degree"/>
    <constant name="TOFEndcapOuterMod1_x1"            value="2.0*TOFEndcapOuter_rmin1*sin(TOFEndcapOuterModOpeningAngle/2.0)"/>
    <constant name="TOFEndcapOuterMod1_x2"            value="2.0*TOFEndcapOuter_rmax1*sin(TOFEndcapOuterModOpeningAngle/2.0)"/>
    <constant name="TOFEndcapOuterMod1_y"             value="TOFEndcapOuter_rmax1*cos(TOFEndcapOuterModOpeningAngle/2.0) - TOFEndcapOuter_rmin1"/>
    <constant name="TOFEndcapOuterMod2_x1"            value="2.0*TOFEndcapOuter_rmin2*sin(TOFEndcapOuterModOpeningAngle/2.0)"/>
    <constant name="TOFEndcapOuterMod2_x2"            value="2.0*TOFEndcapOuter_rmax2*sin(TOFEndcapOuterModOpeningAngle/2.0)"/>
    <constant name="TOFEndcapOuterMod2_y"             value="TOFEndcapOuter_rmax2*cos(TOFEndcapOuterModOpeningAngle/2.0) - TOFEndcapOuter_rmin2"/>
    
    <constant name="ForwardTOF_zmin" value="BarrelTracking_length/2.0 + ForwardTracking_length + ForwardRICH_length + ForwardTRD_length"/>
    <constant name="ForwardTOF_rmin" value="ForwardPID_rmin1"/>
    <constant name="ForwardTOF_rmax" value="Solenoid_rmin"/>
    <constant name="BackwardTOF_zmin" value="BarrelTracking_length/2.0 + BackwardTracking_length + BackwardCherenkov_length "/>
    <constant name="BackwardTOF_rmin" value="ForwardPID_rmin1"/>
    <constant name="BackwardTOF_rmax" value="BarrelTracking_rmax"/>
  </define>

  <detectors>
      
      <detector
        id="ForwardTOF_ID"
        name="ForwardTOF"
        type="ref_DiskTracker"
        insideTrackingVolume="true"
        vis="AnlRed"
        reflect="false">
        <module name="Module1" vis="AnlProcess_Blue">
          <trd x1="TOFEndcapOuterMod1_x1/2.0" x2="TOFEndcapOuterMod1_x2/2.0" z="TOFEndcapOuterMod1_y/2"/>
          <module_component thickness="ITS3Thickness" material="Silicon" sensitive="true"/>
          <module_component thickness="0.25/100*9.37*cm-ITS3Thickness" material="Silicon"/>
        </module>
        <module name="Module2" vis="AnlProcess_Blue">
          <trd x1="TOFEndcapOuterMod2_x1/2.0" x2="TOFEndcapOuterMod2_x2/2.0" z="TOFEndcapOuterMod2_y/2"/>
          <module_component thickness="ITS3Thickness" material="Silicon" sensitive="true"/>
          <module_component thickness="0.25/100*9.37*cm-ITS3Thickness" material="Silicon"/>
        </module>
        <layer id="1">
          <envelope  vis="AnlRed"
            rmin="TOFEndcapOuter_rmin1"
            rmax="TOFEndcapOuter_rmax1"
            length="TOFEndcapOuterLayer_dz"
            zstart="ForwardTOF_zmin" />
          <ring vis="AnlRed"
            r="TOFEndcapOuter_rmin1+TOFEndcapOuterMod1_y/2.0"
            zstart="0.0*mm"
            nmodules="12" dz="2.5 * mm" module="Module1" />
        </layer>
        <layer id="2">
          <envelope  vis="AnlRed"
            rmin="TOFEndcapOuter_rmin2"
            rmax="TOFEndcapOuter_rmax2"
            length="TOFEndcapOuterLayer_dz"
            zstart="ForwardTOF_zmin + TOFEndcapOuterLayer_dz" />
          <ring vis="AnlRed"
            r="TOFEndcapOuter_rmin2+TOFEndcapOuterMod2_y/2.0"
            zstart="0.0*mm"
            nmodules="12" dz="2.5 * mm" module="Module2" />
        </layer>
      </detector>

      <detector
        id="BackwardTOF_ID"
        name="BackwardTOF"
        type="ref_DiskTracker"
        insideTrackingVolume="true"
        vis="AnlRed"
        reflect="true">
        <module name="Module1" vis="AnlProcess_Blue">
          <trd x1="TOFEndcapOuterMod1_x1/2.0" x2="TOFEndcapOuterMod1_x2/2.0" z="TOFEndcapOuterMod1_y/2"/>
          <module_component thickness="ITS3Thickness" material="Silicon" sensitive="true"/>
          <module_component thickness="0.25/100*9.37*cm-ITS3Thickness" material="Silicon"/>
        </module>
        <module name="Module2" vis="AnlProcess_Blue">
          <trd x1="TOFEndcapOuterMod2_x1/2.0" x2="TOFEndcapOuterMod2_x2/2.0" z="TOFEndcapOuterMod2_y/2"/>
          <module_component thickness="ITS3Thickness" material="Silicon" sensitive="true"/>
          <module_component thickness="0.25/100*9.37*cm-ITS3Thickness" material="Silicon"/>
        </module>
        <layer id="1">
          <envelope  vis="AnlRed"
            rmin="TOFEndcapOuter_rmin1 + 0 * 1.2*cm"
            rmax="TOFEndcapOuter_rmax1"
            length="TOFEndcapOuterLayer_dz"
            zstart="BackwardTOF_zmin" />
          <ring vis="AnlRed"
            r="TOFEndcapOuter_rmin1+TOFEndcapOuterMod1_y/2.0"
            zstart="0.0*mm"
            nmodules="12" dz="2.5 * mm" module="Module1" />
        </layer>
        <layer id="2">
          <envelope  vis="AnlRed"
            rmin="TOFEndcapOuter_rmin2"
            rmax="TOFEndcapOuter_rmax2"
            length="TOFEndcapOuterLayer_dz"
            zstart="BackwardTOF_zmin + TOFEndcapOuterLayer_dz" />
          <ring vis="AnlRed"
            r="TOFEndcapOuter_rmin2+TOFEndcapOuterMod2_y/2.0"
            zstart="0.0*mm"
            nmodules="12" dz="2.5 * mm" module="Module2" />
        </layer>
      </detector>
      
      <!--
    <detector 
      id="ForwardTOF_ID"
      name="ForwardTOF"
      type="ref_DiskTracker"
      insideTrackingVolume="true"
      reflect="false"
      vis="AnlOrange">
      <position x="0" y="0" z="0.0"/>
      <layer id="1" 
        vis="AnlOrange"
        inner_z="ForwardTOF_zmin" 
        inner_r="ForwardTOF_rmin" 
        outer_r="ForwardTOF_rmax">
        <slice material="Air" thickness="ForwardTOF_length/2.0" vis="AnlOrange" />
      </layer>
    </detector>

    <detector 
      id="BackwardTOF_ID"
      name="BackwardTOF"
      type="ref_DiskTracker"
      insideTrackingVolume="true"
      reflect="true"
      vis="AnlOrange">
      <position x="0" y="0" z="0.0"/>
      <layer id="1" 
        vis="AnlOrange"
        inner_z="BackwardTOF_zmin" 
        inner_r="BackwardTOF_rmin" 
        outer_r="BackwardTOF_rmax">
        <slice material="Air" thickness="BackwardTOF_length/2.0" vis="AnlOrange" />
      </layer>
    </detector>-->

  </detectors>

</lccdd>
