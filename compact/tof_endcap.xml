<?xml version="1.0" encoding="UTF-8"?>
<lccdd>
  <define>
    <comment> Main diagonal direction for barrel/endcap transitions </comment>
    <constant name="TrackerMainDiagonal_tan"                value="Eta1_1_tan"/>

    <comment> Medial tracker setup </comment>
    <constant name="TOFBarrel_rmin"               value="52*cm"/>

    <constant name="LGADKaptonOverlay_thickness"              value="50*um"/>
    <constant name="LGADCuGround_thickness"                   value="1.58*um"/>
    <constant name="LGADPCB_thickness"                        value="100*um"/>
    <constant name="LGADCuStrip_thickness"                    value="12*um"/>
    <constant name="LGADKaptonStrip_thickness"                value="75*um"/>
    <constant name="LGADResistiveStrip_thickness"             value="128*um"/>
    <constant name="LGADGas_thickness"                        value="20*um"/>
    <constant name="LGADMesh_thickness"                       value="18*um"/>
    <constant name="LGADGasGap_thickness"                     value="3000*um"/>
    <constant name="LGADDriftCuElectrode_thickness"           value="5*um"/>
    <constant name="LGADDriftKapton_thickness"                value="250*um"/>
    <constant name="LGADDriftCuGround_thickness"              value="0.41*um"/>
  </define>

  <define>
    <comment> Global MMGAS variables </comment>
    <constant 
      name="LGADTOFBarrelMod_thickness"
      value="LGADKaptonOverlay_thickness + LGADCuGround_thickness + LGADPCB_thickness
           + LGADCuStrip_thickness + LGADKaptonStrip_thickness + LGADResistiveStrip_thickness
           + LGADGas_thickness + LGADMesh_thickness + LGADGasGap_thickness
           + LGADDriftCuElectrode_thickness + LGADDriftKapton_thickness
           + LGADDriftCuGround_thickness" />
    <comment> Medial barrel implementation </comment>
    <comment> The value of InnerTrackerEndcap_zmax is calculated above based on the rmin of the TOFBarrel </comment>
    <constant name="TOFBarrel_length"           value="2 * InnerTrackerEndcap_zmax"/>
    <constant name="TOFBarrelMod_rmin"         value="TOFBarrel_rmin"/>
    <constant name="TOFBarrelMod_length"        value="TOFBarrel_length - 2*um" />
    <constant name="TOFBarrelMod_count"         value="128" />
    <constant name="TOFBarrelMod_width"        value="2*TOFBarrelMod_rmin * tan(180*degree/TOFBarrelMod_count)" />

    <constant name="TOFBarrelLayer_length"      value="TOFBarrel_length"/>
    <constant name="TOFBarrelLayer_thickness"   value="LGADTOFBarrelMod_thickness + 1.0*cm"/>
    <constant name="TOFBarrelLayer_rmin"       value="TOFBarrelMod_rmin - TOFBarrelLayer_thickness / 5" />
    <constant name="TOFBarrelLayer_rmax"       value="TOFBarrelLayer_rmin + TOFBarrelLayer_thickness" />

    <constant name="TOFBarrelEnvelope_rmin"   value="TOFBarrelLayer_rmin" />
    <constant name="TOFBarrelEnvelope_length" value="TOFBarrelLayer_length" />
  </define>
  <detectors>
    <detector
      id="BarrelTOF_ID"
      name="BarrelTOF"
      type="athena_TrackerBarrel"
      readout="TOFBarrelHits"
      insideTrackingVolume="true">
      <dimensions
        rmin="TOFBarrelEnvelope_rmin"
        rmax="TOFBarrelEnvelope_rmax"
        length="TOFBarrelEnvelope_length"/>
      <module name="TOFBarrel_Mod" vis="TrackerMPGDVis">
        <comment> Going from the inside (sensitive) side to the readout side </comment>
        <module_component name="DriftCuGround" thickness="LGADDriftCuGround_thickness" material="Copper" vis="TrackerMPGDVis" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="DriftKapton" thickness="LGADDriftKapton_thickness" material="Kapton" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="DriftCuElectrode" thickness="LGADDriftCuElectrode_thickness" material="Copper" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="GasGap" thickness="LGADGasGap_thickness" material="Ar90IsoButane" sensitive="True" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="Mesh" thickness="LGADMesh_thickness" material="LGADGAS_InoxForMesh" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="Gas" thickness="LGADGas_thickness" material="Ar90IsoButane" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="ResistiveStrips" thickness="LGADResistiveStrip_thickness" material="LGADGAS_ResistivePaste" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="KaptonStrips" thickness="LGADKaptonStrip_thickness" material="Kapton" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="CuStrips" thickness="LGADCuStrip_thickness" material="Copper" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="PCB" thickness="LGADPCB_thickness" material="Fr4" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="CuGround" thickness="LGADCuGround_thickness" material="Copper" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
        <module_component name="KaptonOverlay" thickness="LGADKaptonOverlay_thickness" material="Kapton" vis="TrackerSupportVis" width="TOFBarrelMod_width" length="TOFBarrelMod_length"/>
      </module>
      <layer module="TOFBarrel_Mod" id="1" vis="TrackerLGADGASLayerVis">
        <barrel_envelope
          inner_r="TOFBarrelLayer_rmin"
          outer_r="TOFBarrelLayer_rmax"
          z_length="TOFBarrelLayer_length"/>
        <layer_material surface="outer" binning="binPhi,binZ" bins0="10*TOFBarrelMod_count" bins1="100" />
        <rphi_layout phi_tilt="0" nphi="TOFBarrelMod_count" phi0="0.0" rc="TOFBarrelMod_rmin" dr="0.0 * mm"/>
        <z_layout dr="0.0 * mm" z0="0.0 * mm" nz="1"/>
      </layer>
    </detector>
  </detectors>

  <readouts>
    <readout name="TOFBarrelHits">
      <segmentation type="CartesianGridXY" grid_size_x="0.150*mm*sqrt(12)" grid_size_y="0.150*mm*sqrt(12)" />
      <id>system:8,layer:4,module:12,sensor:2,x:32:-14,y:-18</id>
    </readout>
  </readouts>

</lccdd>
