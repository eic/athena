<?xml version="1.0" encoding="UTF-8"?>
<lccdd>

  <define>
    <comment>
      --------------------------
      Barrel TOF Parameters
      --------------------------
    </comment>

    <constant name="BarrelTOF_rmin_design"       value="50.0*cm"/>
    <constant name="BarrelTOF_rmin_actual"       value="52.5*cm"/>
    <constant name="BarrelTOF_scale"             value="BarrelTOF_rmin_actual / BarrelTOF_rmin_design"/>
    
    <constant name="BarrelTOF_Sensor_thickness"  value="0.3*mm"/>
    <constant name="BarrelTOF_Module_thickness"  value="1.1/100*9.37*cm"/>
    <constant name="BarrelTOF_Service_thickness" value="BarrelTOF_Module_thickness-BarrelTOF_Sensor_thickness"/>
    <constant name="BarrelTOF_rOffset"     value="10.0*mm"/>
    <comment>
      rOffset is used to add inside space so the _rmin value is the nominal sensor radius.
    </comment>

    <constant name="BarrelTOF_Module_tiltangle"  value="18.0*degree"/>
    <constant name="BarrelTOF_Module_width"      value="32.0*mm * BarrelTOF_scale"/>
    <constant name="BarrelTOF_Module_nphi"       value="108"/>
    <constant name="BarrelTOF_Module_nz"         value="48"/>

    <constant name="BarrelTOF_rmin"       value="BarrelTOF_rmin_actual"/>
    <constant name="BarrelTOF_rmax"       value="BarrelTOF_rmin + BarrelTOF_Module_width * tan(BarrelTOF_Module_tiltangle)"/>
    <constant name="BarrelTOF_thickness"  value="BarrelTOF_rmax - BarrelTOF_rmin"/>
    <constant name="BarrelTOF_length1"    value="2 * BarrelTOF_rmin / TrackerMainDiagonal_tan * 0.995"/>
    <constant name="BarrelTOF_length2"    value="2 * BarrelTOF_rmax / TrackerMainDiagonal_tan * 0.995"/>
    <constant name="BarrelTOF_length"     value="BarrelTOF_length2"/>

  </define>

  <display>
  </display>

  <detectors>
    <detector
      id="BarrelTOF_ID"
      name="BarrelTOF"
      type="athena_TOFBarrel"
      readout="BarrelTOFHits"
      insideTrackingVolume="true">
      <dimensions
        rmin="BarrelTOF_rmin-BarrelTOF_rOffset"
        rmax="BarrelTOF_rmax+BarrelTOF_rOffset"
        length="BarrelTOF_length"/>
      <comment>
        Tracker Barrel Modules
      </comment>
      <module name="BarrelTOF_Module1" vis="TOFVis">
        <module_component name="silicon" material="Silicon" sensitive="true"
          width="BarrelTOF_Module_width" length="BarrelTOF_length1" thickness="BarrelTOF_Sensor_thickness" >
        </module_component>
        <module_component name="service" material="Silicon" sensitive="false"
          width="BarrelTOF_Module_width" length="BarrelTOF_length1" thickness="BarrelTOF_Service_thickness" />
      </module>
      <layer module="BarrelTOF_Module1" id="1" vis="TOFVis">
        <barrel_envelope
          inner_r="BarrelTOF_rmin-BarrelTOF_rOffset"
          outer_r="BarrelTOF_rmax+BarrelTOF_rOffset"
          z_length="BarrelTOF_length"/>
        <rphi_layout phi_tilt="BarrelTOF_Module_tiltangle" nphi="BarrelTOF_Module_nphi" phi0="0.0" rc="BarrelTOF_rmin" dr="0.0 * mm"/>
        <z_layout dr="0.0 * mm" z0="0.0 * mm" nz="BarrelTOF_Module_nz"/>
      </layer>
    </detector>
  </detectors>

  <readouts>
    <readout name="BarrelTOFHits">
      <segmentation type="CartesianGridXY" grid_size_x="0.05*mm" grid_size_y="BarrelTOF_length1/BarrelTOF_Module_nz" />
      <id>system:8,layer:4,module:12,sensor:2,x:32:-16,y:-16</id>
    </readout>
  </readouts>

</lccdd>
